# app_store_connect api generating project

[Generation utility repository](https://github.com/gibahjoe/openapi-generator-dart)

## Algorithm
* Delete everything except `generator` and `.vscode` folders at `../`
* Take latest version source file of app_store_connect open api from [here](https://developer.apple.com/documentation/appstoreconnectapi)
* Save this file `into open_api/api.json`
* Run flutter `flutter pub run build_runner build --delete-conflicting-outputs` command to generate dart api (takes around 2 mins)
* After api is generated - go to the generated project path (`cd ../`)
* delete test folder
* fix [api gen issues](#api-generation-issue) on generated project
* run `flutter pub run build_runner build` on generated project to generate dio serializables (takes around 5 mins)
* fix [dio issues](#dio-generation-issues) on generated serializables
* run `dart format --line-length=120 .` on generated project
* run `dart fix --apply` on generated project


## API generation issues
### Same enums names 
SubscriptionStatusUrlVersion has same naming issue so you need to replace 
this code
```
class SubscriptionStatusUrlVersion extends EnumClass {

  @BuiltValueEnumConst(wireName: r'V1')
  static const SubscriptionStatusUrlVersion v1 = _$v1;
  @BuiltValueEnumConst(wireName: r'V2')
  static const SubscriptionStatusUrlVersion v2 = _$v2;
  @BuiltValueEnumConst(wireName: r'v1')
  static const SubscriptionStatusUrlVersion v1 = _$v1;
  @BuiltValueEnumConst(wireName: r'v2')
  static const SubscriptionStatusUrlVersion v2 = _$v2;

  ...
```
to this code
```
class SubscriptionStatusUrlVersion extends EnumClass {

  @BuiltValueEnumConst(wireName: r'V1')
  static const SubscriptionStatusUrlVersion v_1 = _$v_1;
  @BuiltValueEnumConst(wireName: r'V2')
  static const SubscriptionStatusUrlVersion v_2 = _$v_2;
  @BuiltValueEnumConst(wireName: r'v1')
  static const SubscriptionStatusUrlVersion v1 = _$v1;
  @BuiltValueEnumConst(wireName: r'v2')
  static const SubscriptionStatusUrlVersion v2 = _$v2;
  
  ...
```

---
## DIO generation issues
### Duplicated build (property and function)
Some classes generated by dio have same named getter, setter and function (build)

In order to prevent errors you need to rename _build variable and build getter/setter to
_buildBuilder and buildBuilder. 

Also you will have to rename all references of those variable
in all the dependent places.

As of app_store_connect api version 2.0, next files have this issue:
* app_store_version_create_request_data_relationships.g.dart
* app_store_version_relationships.g.dart
* app_store_version_update_request_data_relationships.g.dart
* beta_app_review_submission_create_request_data_relationships.g.dart
* beta_app_review_submission_relationships.g.dart

Example

generated:
```
  AppStoreVersionRelationshipsBuildBuilder? _build;
  AppStoreVersionRelationshipsBuildBuilder get build =>
      _$this._build ??= new AppStoreVersionRelationshipsBuildBuilder();
  set build(AppStoreVersionRelationshipsBuildBuilder? build) =>
      _$this._build = build;
```

should be:

```
  AppStoreVersionRelationshipsBuildBuilder? _buildBuilder;
  AppStoreVersionRelationshipsBuildBuilder get buildBuilder =>
      _$this._buildBuilder ??= new AppStoreVersionRelationshipsBuildBuilder();
  set buildBuilder(AppStoreVersionRelationshipsBuildBuilder? build) =>
      _$this._buildBuilder = build;
```